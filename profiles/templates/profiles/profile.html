{% extends 'base.html' %}
{% load static %}

{% block extra_meta %}
<meta name="description" content="Personalised profile page">
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'profiles/css/profiles.css' %}">
{% endblock %}

{% block extra_title %} | My profile{% endblock %}


{% block page_header%}
    <header>
        <div class="container-fluid d-flex justify-content-center">
        
            <div class="row">
                <div class="col"><h1>My profile</h1></div>
            </div>
        </div>
        
    </header>
{% endblock %}




{% block content %}
<main>
    <div class="container-fluid d-flex justify-content-center">
        <div class="row">
            <section>
            <div class="col-md-7 my-2">

                <h2>Default personal information</h2>
                <form class="mt-3" action="{% url 'profile' %}" method="POST" id="profile-update-form" enctype="multipart/form-data">
                    <p>Input your phone number and level according to <a href="https://activenetwork.my.salesforce-sites.com/usta/articles/en_US/Article/League-NTRP-Rating-Information" target="_blank" class="link-text">NTRP</a>.</p>
                    {% csrf_token %}
                    
                    
                    {{ form.default_phone | as_crispy_field }}
                    {{ form.level | as_crispy_field }}
                    
                    {% if not profile.profile_image.url %} 
                    <p>You have not added a profile image</p>
                    {% else %}                       
                        <p class="mb-0">Current profile image:<img src="{{ profile.profile_image.url }}" alt="{{ request.user }} profile image" class="d-block profile-image py-3"></p>
                    {% endif %}

                    {{ form.profile_image }}

                    <button class="btn login-button">Update</button>
                </form> 
                
            </div>
            </section>
            <section>
            <div class="col-md-5 my-2">

                <h2>Booking history</h2>
                {% if orders %}
                <p>Click on the booking number to view the booking details.</p>

                {% for order in orders %}
                <p>
                {{ order.order_date }} <a class="link-text" href="{% url 'order_history' order.order_number %}" title="{{ order.order_number }}">{{ order.order_number|truncatechars:6 }}</a>
                </p>
                {% endfor %}

                {% else %}
                <p>You have no previous bookings.</p>
                {% endif %}

                
                
                


                    

            </div>
            </section>
        </div>
    </div>
        



</main>
{% endblock %}

<!--From Boutique Ado-->
{% block postloadjs %}
    {{ block.super }}
    <script type="text/javascript">
        $('#new-image').change(function() {
            let file = $('#new-image')[0].files[0];
            $('#filename').text(`Click Update to set image to: ${file.name}`);
        });
    </script>
{% endblock %}

